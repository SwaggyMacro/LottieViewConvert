<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:suki="https://github.com/kikipoulet/SukiUI"
             xmlns:vm="using:LottieViewConvert.ViewModels"
             xmlns:objectModel="clr-namespace:System.Collections.ObjectModel;assembly=System.ObjectModel"
             xmlns:lang="clr-namespace:LottieViewConvert.Lang"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="LottieViewConvert.Views.SettingView"
             x:DataType="vm:SettingViewModel">

    <Grid>
        <!-- Status -->
        <Border Background="{DynamicResource SukiCardBackground}"
                CornerRadius="8"
                Padding="12,8"
                Margin="16"
                VerticalAlignment="Top"
                ZIndex="1"
                IsVisible="{Binding HasStatusMessage}">
            <TextBlock Text="{Binding StatusMessage}"
                       FontWeight="Medium"
                       HorizontalAlignment="Center"
                       Foreground="{DynamicResource SukiAccentColor}"/>
        </Border>

        <!-- Loading overlay -->
        <Border Background="Black"
                Opacity="0.3"
                ZIndex="2"
                IsVisible="{Binding IsLoading}"/>
        
        <StackPanel HorizontalAlignment="Center" 
                    VerticalAlignment="Center"
                    Spacing="10"
                    ZIndex="3"
                    IsVisible="{Binding IsLoading}">
            <suki:CircleProgressBar IsIndeterminate="True" 
                                      Width="32" 
                                      StrokeWidth="2"
                                      Height="32"/>
            <TextBlock Text="{x:Static lang:Resources.Processing}"
                       HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- MainContent -->
        <DockPanel IsEnabled="{Binding !IsLoading}">
            <!-- Operation button -->
            <StackPanel DockPanel.Dock="Bottom"
                        Orientation="Horizontal" 
                        Spacing="10"
                        HorizontalAlignment="Right"
                        Margin="16">
                <Button Content="{x:Static lang:Resources.ResetConfig}"
                        Command="{Binding ResetCommand}"
                        Classes="Outlined"/>
                <Button Content="{x:Static lang:Resources.Save}"
                        Command="{Binding SaveCommand}"
                        Classes="Accent"/>
            </StackPanel>

            <!-- SettingsLayout -->
            <suki:SettingsLayout>
                <suki:SettingsLayout.Items>
                    <objectModel:ObservableCollection x:TypeArguments="suki:SettingsLayoutItem">
                        <!-- Language Settings -->
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.LanguageSettings}">
                            <suki:SettingsLayoutItem.Content>
                                <suki:GroupBox Header="{x:Static lang:Resources.DisplayLanguage}" Margin="0,10">
                                    <StackPanel Spacing="15">
                                        <StackPanel Spacing="8">
                                            <TextBlock Text="{x:Static lang:Resources.Language}" 
                                                       FontWeight="Medium"/>
                                            <ComboBox SelectedValue="{Binding SelectedLanguage}"
                                                      ItemsSource="{Binding AvailableLanguages}"
                                                      DisplayMemberBinding="{Binding DisplayName}"
                                                      SelectedValueBinding="{Binding Code}"
                                                      MinWidth="200"/>
                                            <TextBlock Text="{x:Static lang:Resources.LanguageChangeDesc}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SukiText}"
                                                       Opacity="0.7"/>
                                        </StackPanel>
                                    </StackPanel>
                                </suki:GroupBox>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <!-- Network setting -->
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.NetworkSettings}">
                            <suki:SettingsLayoutItem.Content>
                                <suki:GroupBox Header="{x:Static lang:Resources.Proxy}" Margin="0,10">
                                    <StackPanel Spacing="15">
                                        <StackPanel Spacing="8">
                                            <TextBlock Text="{x:Static lang:Resources.ProxyUrl}" 
                                                       FontWeight="Medium"/>
                                            <TextBox Text="{Binding ProxyAddress}"
                                                     Watermark="{x:Static lang:Resources.ProxyUrlSettingDesc}"/>
                                            <TextBlock Text="{x:Static lang:Resources.SupportHttpAndSocks}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SukiText}"
                                                       Opacity="0.7"/>
                                        </StackPanel>
                                    </StackPanel>
                                </suki:GroupBox>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>

                        <!-- Telegram Settings -->
                        <suki:SettingsLayoutItem Header="{x:Static lang:Resources.TelegramSettings}">
                            <suki:SettingsLayoutItem.Content>
                                <suki:GroupBox Header="{x:Static lang:Resources.BotConfig}" Margin="0,10">
                                    <StackPanel Spacing="15">
                                        <StackPanel Spacing="8">
                                            <TextBlock Text="Bot Token" 
                                                       FontWeight="Medium"/>
                                            <TextBox Text="{Binding TelegramBotToken}"
                                                     Watermark="{x:Static lang:Resources.InputTelegramBotToken}"
                                                     PasswordChar="*"/>
                                            <TextBlock FontSize="12"
                                                       Foreground="{DynamicResource SukiText}"
                                                       Opacity="0.7">
                                                <Run Text="{x:Static lang:Resources.CreateAndGetFromBotFather}"/>
                                                <LineBreak/>
                                                <Run Text="{x:Static lang:Resources.BotTokenExample}"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                </suki:GroupBox>
                            </suki:SettingsLayoutItem.Content>
                        </suki:SettingsLayoutItem>
                    </objectModel:ObservableCollection>
                </suki:SettingsLayout.Items>
            </suki:SettingsLayout>
        </DockPanel>
    </Grid>

</UserControl>